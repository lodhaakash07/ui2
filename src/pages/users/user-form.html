<!--
  Generated template for the UserForm pemail.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pemails and navigation.
-->
<ion-header>

  <ion-navbar color="primary">
    <ion-title>User</ion-title>
  </ion-navbar>

</ion-header>


<ion-content padding>

  <p *ngIf="submitAttempt" style="color: #ea6153;">Please fill out all details accurately.</p>

  <ion-list no-lines>

    <form [formGroup]="slideOneForm">

      <ion-item id="company_id" *ngIf="companies">
        <ion-label floating>Company</ion-label>
        <ion-select name="company_id" [(ngModel)]="user.company_id" [class.invalid]="!slideOneForm.controls.company_id.valid && (slideOneForm.controls.company_id.dirty || submitAttempt)"
          formControlName="company_id">
          <ion-option  *ngFor="let company of companies" [value]="company.id">{{company.name}}</ion-option>
        </ion-select>
      </ion-item>

      
      <ion-item id="gender">
        <ion-label floating>Gender</ion-label>
        <ion-select name="gender" [(ngModel)]="user.gender" [class.invalid]="!slideOneForm.controls.gender.valid && (slideOneForm.controls.gender.dirty || submitAttempt)"
          formControlName="gender">
          <ion-option value="M">Male</ion-option>
          <ion-option value="F">Female</ion-option>
        </ion-select>
      </ion-item>


      <ion-item>
        <ion-label floating>First Name</ion-label>
        <ion-input name="first_name" formControlName="first_name" type="text" [(ngModel)]="user.first_name" [class.invalid]="!slideOneForm.controls.first_name.valid && (slideOneForm.controls.first_name.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.first_name.valid  && (slideOneForm.controls.first_name.dirty || submitAttempt)">
        <p class="error-text">Please enter a valid name.</p>
      </ion-item>

      <ion-item>
        <ion-label floating>Last Name</ion-label>
        <ion-input name="last_name" formControlName="last_name" type="text" [(ngModel)]="user.last_name" [class.invalid]="!slideOneForm.controls.last_name.valid && (slideOneForm.controls.email.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.last_name.valid  && (slideOneForm.controls.last_name.dirty || submitAttempt)">
        <p class="error-text">Please enter a valid name.</p>
      </ion-item>

      <ion-item>
        <ion-label floating>Email</ion-label>
        <ion-input name="email" formControlName="email" type="email" [(ngModel)]="user.email" [class.invalid]="!slideOneForm.controls.email.valid && (slideOneForm.controls.email.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.email.valid  && (slideOneForm.controls.email.dirty || submitAttempt)">
        <p class="error-text">Please enter a valid email.</p>
      </ion-item>

      <ion-item *ngIf="!user.id">
        <ion-label floating>Password</ion-label>
        <ion-input name="password" formControlName="password" type="password" [(ngModel)]="user.password" [class.invalid]="!slideOneForm.controls.password.valid && (slideOneForm.controls.password.dirty || submitAttempt)"></ion-input>
      </ion-item>
      <ion-item *ngIf="!slideOneForm.controls.password.valid && (slideOneForm.controls.password.dirty || submitAttempt)">
        <p class="error-text">Must be min 6 chars long.</p>
      </ion-item>


      <ion-item *ngIf="!user.id">
        <ion-label floating>Confirm Password</ion-label>
        <ion-input name="confirm_password" formControlName="confirm_password" type="password" [(ngModel)]="confirm_password" [class.invalid]="!slideOneForm.controls.confirm_password.valid && (slideOneForm.controls.confirm_password.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.confirm_password.valid && (slideOneForm.controls.confirm_password.dirty || submitAttempt)">
        <p class="error-text">Passwords dont match.</p>
      </ion-item>

      <ion-item>
        <ion-label floating>Phone</ion-label>
        <ion-input name="phone" formControlName="phone" type="number" [(ngModel)]="user.phone" [class.invalid]="!slideOneForm.controls.phone.valid && (slideOneForm.controls.email.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.phone.valid  && (slideOneForm.controls.phone.dirty || submitAttempt)">
        <p class="error-text">Enter a valid 11 digit phone number starting with 0.</p>
      </ion-item>

      <ion-item>
        <ion-label floating>Birth Year</ion-label>
        <ion-input name="birth_year" formControlName="birth_year" type="number" [(ngModel)]="user.birth_year" [class.invalid]="!slideOneForm.controls.birth_year.valid && (slideOneForm.controls.email.dirty || submitAttempt)"></ion-input>
      </ion-item>

      <ion-item *ngIf="!slideOneForm.controls.birth_year.valid  && (slideOneForm.controls.birth_year.dirty || submitAttempt)">
        <p class="error-text">Enter a valid birth year in YYYY format.</p>
      </ion-item>


      <div *ngIf="user.role == 'Coach'">


      </div>

      <div text-wrap>
        <ion-item>
          <ion-checkbox id="accept_terms" [(ngModel)]="user.accept_terms" 
          formControlName="accept_terms" type="text" 
          (ionChange)="onTermsChecked($event)"></ion-checkbox>
          <ion-label text-warp>I have read and agree to the Terms & Conditions</ion-label>
        </ion-item>
        <button ion-button full clear color="primary" (click)="show_terms()">Terms & Conditions</button>
        <ion-item *ngIf="!slideOneForm.controls.accept_terms.valid  && (slideOneForm.controls.accept_terms.dirty || submitAttempt)">
          <p class="error-text">Please accept the T&C.</p>
        </ion-item>
      </div>

    </form>

  </ion-list>

  <button ion-button full color="primary" (click)="save()" [disabled]="slideOneForm.invalid">Save</button>

</ion-content>